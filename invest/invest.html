<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>MoneyMind – Invest</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../style.css" />
    <link rel="stylesheet" href="./invest.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script defer src="./invest.js"></script>
  </head>
  <body>
    <nav class="navbar">
      <div class="nav-logo">
        <h2><span>Money</span>Mind</h2>
      </div>
      <ul class="nav-links">
        <li><a href="../dashboard/dashboard.html">Dashboard</a></li>
        <li><a href="../profile/profile.html">Profile</a></li>
        <li><a href="./invest.html" class="active">Invest</a></li>
      </ul>
      <button class="logout-btn" id="logoutBtn">Logout</button>
    </nav>

    <main class="dashboard">
      <header class="dashboard-header">
        <div>
          <p class="subtitle">Trading &amp; investing</p>
          <h2>Invest</h2>
          <p class="muted">
            Browse markets, open simulated positions and track them per account.
          </p>
        </div>
        <div class="header-actions">
          <div id="currentAccountChip" class="header-pill">
            Account:
            <span id="currentAccountName">-</span> •
            <span id="currentAccountType">-</span> •
            <span id="currentAccountBalance">0.00</span>
          </div>
          <button class="primary-ghost" id="goProfileBtn">
            Change account in Profile
          </button>
        </div>
      </header>

      <section class="invest-layout">
        <div class="card watchlist-card">
          <div class="panel-header">
            <div>
              <h3>Markets</h3>
              <p class="card-caption">
                Search instruments and manage your watchlist.
              </p>
            </div>
          </div>

          <div class="market-tabs">
            <button class="market-tab active" data-market="all">All</button>
            <button class="market-tab" data-market="crypto">Crypto</button>
            <button class="market-tab" data-market="forex">Forex</button>
            <button class="market-tab" data-market="stocks">Stocks</button>
          </div>

          <div class="search-wrapper">
            <input
              type="text"
              id="instrumentSearch"
              placeholder="Search by name or symbol..."
            />
          </div>

          <div class="watchlist-section">
            <div class="watchlist-header">
              <span>Watchlist</span>
              <span id="watchlistCount" class="muted-small">0 items</span>
            </div>

            <div class="watchlist-groups">
              <div class="watchlist-group" id="watchlistGroupCrypto">
                <div class="watchlist-header-sub">Crypto</div>
                <ul id="watchlistCrypto" class="instrument-list"></ul>
              </div>

              <div class="watchlist-group" id="watchlistGroupForex">
                <div class="watchlist-header-sub">Forex</div>
                <ul id="watchlistForex" class="instrument-list"></ul>
              </div>

              <div class="watchlist-group" id="watchlistGroupStocks">
                <div class="watchlist-header-sub">Stocks</div>
                <ul id="watchlistStocks" class="instrument-list"></ul>
              </div>
            </div>
          </div>

          <div class="all-markets-section">
            <div class="watchlist-header">
              <span>All instruments</span>
            </div>
            <ul id="instrumentList" class="instrument-list"></ul>
          </div>
        </div>

        <div class="card chart-card">
          <div class="panel-header">
            <div>
              <h3 id="chartTitle">Select an instrument</h3>
              <p class="card-caption" id="chartSubtitle">
                Choose a symbol from the markets list to load a chart.
              </p>
            </div>
            <div class="timeframe-controls">
              <button class="tf-btn" data-tf="1m">1m</button>
              <button class="tf-btn" data-tf="15m">15m</button>
              <button class="tf-btn" data-tf="30m">30m</button>
              <button class="tf-btn" data-tf="1h">1H</button>
              <button class="tf-btn" data-tf="4h">4H</button>
              <button class="tf-btn active" data-tf="1D">1D</button>
              <button class="tf-btn" data-tf="1W">1W</button>
              <button class="tf-btn" data-tf="1M">1M</button>
              <button class="tf-btn" data-tf="1Y">1Y</button>
            </div>
          </div>
          <div class="chart-container">
            <canvas id="priceChart"></canvas>
          </div>
        </div>

        <div class="card trade-card">
          <div class="panel-header">
            <div>
              <h3>Order ticket</h3>
              <p class="card-caption">
                Open simulated positions on the selected instrument.
              </p>
            </div>
          </div>

          <div class="ticket-instrument">
            <span id="ticketInstrumentSymbol">–</span>
            <span id="ticketInstrumentName" class="muted-small">
              Select an instrument to trade.
            </span>
          </div>

          <form id="orderForm" class="order-form">
            <div class="side-toggle">
              <button
                type="button"
                class="side-btn active"
                data-side="buy"
              >
                Buy
              </button>
              <button type="button" class="side-btn" data-side="sell">
                Sell
              </button>
              <input type="hidden" id="orderSide" value="buy" />
            </div>

            <label class="order-field">
              <span>Quantity</span>
              <input
                type="number"
                id="orderQty"
                min="0"
                step="0.0001"
                placeholder="0.01"
              />
            </label>

            <label class="order-field">
              <span>Price</span>
              <input
                type="number"
                id="orderPrice"
                min="0"
                step="0.01"
                placeholder="Market price"
              />
            </label>

            <label class="order-field">
              <span>Stop loss (optional)</span>
              <input
                type="number"
                id="orderSl"
                min="0"
                step="0.01"
              />
            </label>

            <label class="order-field">
              <span>Take profit (optional)</span>
              <input
                type="number"
                id="orderTp"
                min="0"
                step="0.01"
              />
            </label>

            <button
              type="submit"
              class="primary-btn"
              id="placeOrderBtn"
              disabled
            >
              Place order
            </button>
            <p class="muted-small" id="orderInfo">
              Select an instrument and fill in the quantity.
            </p>
          </form>
        </div>
      </section>

      <section class="card positions-section-wide">
        <div class="accounts-header">
          <h2>Open positions</h2>
          <p class="card-caption">
            All simulated trades opened on the selected account.
          </p>
        </div>

        <div class="positions-list-header">
          <span class="muted-small">Showing open positions for this account.</span>
          <span class="muted-small">
            <span id="openPositionsCount">0</span> open
          </span>
        </div>

        <div class="positions-list" id="openPositionsList">
        </div>
      </section>

      <footer class="footer">
        <p>
          © 2025 <span>MoneyMind</span> • Made by Darius
        </p>
      </footer>

      <div id="watchlistOverlay" class="wishlist-overlay"></div>
      <div id="watchlistCategoryPanel" class="wishlist-panel">
        <div class="wishlist-panel-inner">
          <h4>Add to watchlist</h4>
          <p class="muted-small" id="wishlistPanelInstrumentLabel"></p>

          <div class="wishlist-category-buttons">
            <button type="button" class="wishlist-cat-btn" data-type="crypto">
              Crypto
            </button>
            <button type="button" class="wishlist-cat-btn" data-type="forex">
              Forex
            </button>
            <button type="button" class="wishlist-cat-btn" data-type="stocks">
              Stocks
            </button>
          </div>

          <div class="wishlist-panel-actions">
            <button type="button" id="wishlistCancelBtn">Cancel</button>
          </div>
        </div>
      </div>
    </main>
  </body>
</html>
